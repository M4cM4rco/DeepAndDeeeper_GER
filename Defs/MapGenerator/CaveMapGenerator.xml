<?xml version="1.0" encoding="utf-8"?>
<Defs>

  <MapGeneratorDef Name="ShashlichnikUndercave">
    <defName>ShashlichnikUndercave</defName>
    <label>undercave</label>
    <isUnderground>true</isUnderground>
    <forceCaves>true</forceCaves>
    <ignoreAreaRevealedLetter>true</ignoreAreaRevealedLetter>
    <disableCallAid>true</disableCallAid>
    <customMapComponents>
      <li>Shashlichnik.CaveMapComponent</li>
    </customMapComponents>
    <pocketMapProperties>
      <biome>ShashlichnikUndercave</biome>
      <temperature>15</temperature>
    </pocketMapProperties>
    <genSteps>
      <li>ElevationFertility</li>
      <li>ShashlichnikUndercave_RocksFromGrid</li>
      <li>Terrain</li>
      <!--<li>CavesTerrain</li>-->
      <li>ShashlichnikUndercave_ScatterRuinsSimple</li>
			<li>ShashlichnikUndergroundTorches</li>
			<li>ShashlichnikUndergroundLakes</li>
      <li>ShashlichnikFindCaveExit</li>
			<li>ShashlichnikCaveExitToSurfaceInterest</li>
      <li>ShashlichnikUndercave_Caves</li>
      <li>RockChunks</li>
			<li>ShashlichnikScatterShrines</li>
      <li>ShashlichnikUndercaveInterest</li>
      <li>Plants</li>
      <li>Fog</li>
    </genSteps>
  </MapGeneratorDef>

  <GenStepDef>
    <defName>ShashlichnikUndercave_Caves</defName>
    <order>11</order>
    <genStep Class="GenStep_Caves">
      <branchChance>0.001</branchChance>
      <minTunnelWidth>3</minTunnelWidth>
      <widthOffsetPerCell>0.008</widthOffsetPerCell>
    </genStep>
  </GenStepDef>

  <GenStepDef>
    <defName>ShashlichnikUndercave_RocksFromGrid</defName>
    <order>200</order>
    <genStep Class="GenStep_RocksFromGrid">
      <overrideBlotchesPer10kCells>10</overrideBlotchesPer10kCells>
    </genStep>
  </GenStepDef>

  <!-- Undercave ruins -->
  <GenStepDef>
    <defName>ShashlichnikUndercave_ScatterRuinsSimple</defName>
    <order>249</order>
    <genStep Class="GenStep_ScatterRuinsSimple">
      <allowInWaterBiome>false</allowInWaterBiome>
      <countPer10kCellsRange>2~3</countPer10kCellsRange>
      <mustBeStandable>true</mustBeStandable>
      <canBeOnEdge>true</canBeOnEdge>
      <ruinSizeChanceCurve>
        <points>
          <li>(6, 0)</li>
          <li>(6.001, 4)</li>
          <li>(10, 0)</li>
        </points>
      </ruinSizeChanceCurve>
      <destroyChanceExp>3</destroyChanceExp>
      <clearSurroundingArea>true</clearSurroundingArea>
    </genStep>
  </GenStepDef>

  <GenStepDef>
    <defName>ShashlichnikFindCaveExit</defName>
    <order>300</order>
    <genStep Class="Shashlichnik.GenStep_FindCaveExit"/>
  </GenStepDef>
	
	<GenStepDef>
		<defName>ShashlichnikCaveExitToSurfaceInterest</defName>
		<order>301</order>
		<genStep Class="Shashlichnik.GenStep_ExitToSurfaceInterest"/>
	</GenStepDef>


  <GenStepDef>
    <defName>ShashlichnikUndercaveInterest</defName>
    <order>650</order>
    <genStep Class="Shashlichnik.GenStep_CaveInterest" />
  </GenStepDef>

	<GenStepDef>
		<defName>ShashlichnikScatterShrines</defName>
		<order>400</order>
		<genStep Class="GenStep_ScatterShrines">
			<allowInWaterBiome>false</allowInWaterBiome>
			<countPer10kCellsRange>
				<min>0.12</min>
				<max>0.25</max>
			</countPer10kCellsRange>
			<canBeOnEdge>true</canBeOnEdge>
		</genStep>
	</GenStepDef>

	<GenStepDef>
		<defName>ShashlichnikUndergroundTorches</defName>
		<order>298</order>
		<genStep Class="Shashlichnik.GenStep_UndergroundTorches"/>
	</GenStepDef>
	
	<GenStepDef>
		<defName>ShashlichnikUndergroundLakes</defName>
		<order>299</order>
		<genStep Class="Shashlichnik.GenStep_UndergroundLakes"/>
	</GenStepDef>


	<BiomeDef>
    <defName>ShashlichnikUndercave</defName>
    <label>undercave</label>
    <description>Ordinary caves, at least at first glance.</description>
    <generatesNaturally>false</generatesNaturally>
    <animalDensity>0</animalDensity>
    <plantDensity>0.20</plantDensity>
    <wildAnimalsCanWanderInto>false</wildAnimalsCanWanderInto>
    <baseWeatherCommonalities>
			<ShashlichnikUnderground>1</ShashlichnikUnderground>
    </baseWeatherCommonalities>
    <diseaseMtbDays>80</diseaseMtbDays>
    <diseases>
      <li>
        <diseaseInc>Disease_Flu</diseaseInc>
        <commonality>100</commonality>
      </li>
      <li>
        <diseaseInc>Disease_Plague</diseaseInc>
        <commonality>80</commonality>
      </li>
      <li>
        <diseaseInc>Disease_FibrousMechanites</diseaseInc>
        <commonality>40</commonality>
      </li>
      <li>
        <diseaseInc>Disease_SensoryMechanites</diseaseInc>
        <commonality>40</commonality>
      </li>
      <li>
        <diseaseInc>Disease_GutWorms</diseaseInc>
        <commonality>30</commonality>
      </li>
      <li>
        <diseaseInc>Disease_MuscleParasites</diseaseInc>
        <commonality>30</commonality>
      </li>
      <li>
        <diseaseInc>Disease_AnimalFlu</diseaseInc>
        <commonality>100</commonality>
      </li>
      <li>
        <diseaseInc>Disease_AnimalPlague</diseaseInc>
        <commonality>80</commonality>
      </li>
    </diseases>
  </BiomeDef>

</Defs>